---
date: 2025-02-07
tags:
  - cryptography_and_network_security
---

# Use of Random Numbers

A number of network security algorithms and protocols based on cryptography make use of random binary numbers:
- Key distribution and reciprocal authentication schemes
- Session key generation
- Generation of keys for the RSA public-key encryption algorithm
- Generation of a bit stream for symmetric stream encryption

There are two distinct requirements for a sequence of random numbers:
1. Randomness
2. Unpredictability

# Requirements of Random Numbers 

## Randomness

The generation of a sequence of allegedly random numbers being random in some well-defined statistical sense has been a concern. 

Two criteria are used to validate that a sequence of numbers is random:
- Uniform distribution
	- The frequency of occurrence of ones and zeros should be approximately equal
- Independence
	- No one sub sequence in the sequence can be inferred from the others.

## Unpredictability

The requirement is not just that the sequence of numbers be statistically random, but that the successive members of the sequence are unpredictable. 

With "true" random sequences each number is statistically independent of other numbers in the sequence and therefore unpredictable. 
- True random numbers have their limitations, such as inefficiency, so it is more common to implement algorithms that generate sequences of numbers that appear to be random.
- Care must be taken that an opponent not be able to predict future elements of the sequence on the basis of earlier elements.

### Random Number Generators

![[Random Numbers Generators|100%]]

```ad-tldr
TRNG = True random number generator
PRNG = pseudorandom number generator
PRF = pseudorandom function
```

## True Random Number Generator  (TRNG)

Takes as input a source that is effectively random.

The source is referred to as an entropy source and is drawn from the physical environment of the computer.
- Includes things such as keystroke timing patterns, disk electrical activity, mouse movements, and instantaneous values of the system clock.
- The source, or combination of sources, serve as input to an algorithm that produces random binary output.

The TRNG may simply involve conversion of an anolog source to a binary output.

The TRNG may involve additional processing to overcome any bias in the source.

## Pseudorandom Numbers

Cryptographic applications typically make use of algorithmic techniques for random number generation.

These algorithms are deterministic and therefore produce sequences of numbers that are not statistically random.

If the algorithm is good, the resulting sequences will pass many tests of randomness and are referred to as pseudorandom numbers.

## Pseudorandom Number Generator

Takes as input a fixed value, called the seed, and produces a sequence of output bits using a deterministic algorithm.
- Quite often the seed is generated by a TRNG.

The output bit stream is determined solely by the input value (or values), so an adversary who knows the algorithm and the seed can reproduce the entire bit stream.
- Other than the number of bits produced there is no difference between PRNG and a PRF.

**Pseudorandom number generator:** 
- An algorithm that is used to produce an open-ended sequence of bits  
- Input to a symmetric stream cipher is a common application for an open-ended sequence of bits 

**Pseudorandom function:**
- Used to produce a pseudorandom string of bits of some fixed length  
- Examples are symmetric encryption keys and nonces

## PRNG Requirements

The basic requirement when a PRNG or PRF is used for a cryptographic application is that an adversary who does not know the seed is unable to determine the pseudorandom string. 

The requirement for secrecy of the output of a PRNG or PRF leads to specific requirements in the areas of:
- Randomness
- Unpredictability
- Characteristics of the seed

### Randomness

The generated bit stream needs to appear random even though it is deterministic.

There is no single test that can determine if a PRNG generates numbers that have the characteristic of randomness.
- If a PRNG exhibits randomness on the basis of multiple tests, then it can be assumed to satisfy the randomness requirement.

NIST SP 800-22 specifies that the tests should seek to establish three characteristics:
- Uniformity
- Scalability
- Consistency

#### Randomness Tests

**Frequency Test:**
- The most basic test and must be included in any test suite.
- Purpose is to determine whether the number of ones and zeros in a sequence is approximately the same as would be expected for a truly random sequence.

**Runs Test:**
- Focus of this test is the total number of runs in the sequence, where a run is an uninterrupted sequence of identical bits bounded before and after with a bit of the opposite value.
- Purpose is to determine whether the number of runs of ones and zeros of various lengths is as expected for a random sequence.

**Maurer's universal statistical test:**
- Focus is the number of bits between matching patterns
- Purpose is to detect whether or not the sequence can be significantly compressed without loss of information. A significantly comprehensible sequence is considered to be non-random. 

### Unpredictability

A stream of pseudorandom numbers should exhibit two forms of unpredictability:
- Forward unpredictability
	-  If the seed is unknown, the next output bit in the sequence should be unpredictable in spite of any knowledge of previous bits in the sequence.
- Backward unpredictability
	- It should not be feasible to determine the seed from knowledge of any generated values.
	- No correlation between a seed and any value generated from that seed should be evident.
	- Each element of the sequence should appear to be the outcome of an independent random event whose probability is 1/2.

The same set of tests for randomness also provides a test of unpredictability
- A random sequence will have no correlation with a fixed value (the seed)

### Seed Requirements

The seed that serves as input to the PRNG must be secure and unpredictable.

The seed itself must be a random or pseudorandom number.

Typically the seed is generated by TRNG.

![[SeedRequirements Diagram|center|200]]

# Pseudorandom Number Generators

## Algorithm Design/Type

Algorithms fall into two categories:
- Purpose-built algorithms
	- Algorithms designed specifically and solely for the purpose of generating pseudorandom bit streams
- Algorithms based on existing cryptographic algorithms
	- Have the effect of randomising input data

Three broad categories of cryptographic algorithms are commonly used to create PRNGs:
- Symmetric block ciphers
- Asymmetric ciphers
- Hash functions and message authentication


## Purpose-built Algorithms

### Linear Congruential Generator

An algorithm first proposed by Lehmer that is parameterised with four numbers:
- $m$, the modulus. $m > 0$
- $a$, the multiplier. $0 < a < m$
- $c$, the increment. $0 \le c < m$
- $X_{0}$, the starting value, or seed. $0 \le X_{0}<m$

The sequence of random numbers $\{X_{n}\}$ is obtained via the following iterative equation:
$$X_{n+1}=(aX_{n}+c)\mod{m}$$

If $m, a, c,$ and $X_{0}$ are integers, then this technique will produce a sequence of integers with each integer in the range $0 \le X_{n} < m$.

The selection of values for $a, c,$ and $m$ is critical in developing a good random number generator.

### Blum Blum Shub (BBS) Generator

Has perhaps the strongest public proof of its cryptographic strength of any purpose-built algorithm.

Referred to as cryptographically secure pseudorandom bit generator (CSPRBG).
- A CSPRBG is defined as one that passes the next-bit-test if there is not a polynomial-time algorithm that, on input of the first k bits of an output sequence, can predict the (k+1)st bit with probability significantly greater than 1/2.

The security of BBS is based on the difficulty of factoring n.

# Pseudorandom Number Generation Using a Block Cipher

## Using Modes of Operation

Two approaches that use a block cipher to build a PNRG have gained widespread acceptance:
- CTR Mode
	- Reccomended in NIST SP 800-90, ANSI standard X.82, and RFC 4086
- OFB Mode
	- Recommended in X9.82 and RFC 4086

![[Pseudorandom Block Cipher|100%]]

# Stream Ciphers: General Architecture

![[stream ciphers general architecture|100%]]

Plaintext $p_{i}$
Ciphertext $c_{i}$
Keystream $z_{i}$
Key $K$
Initialisation Value $IV$
State $\sigma_{i}$
Next-state function $f$
Keystream function $g$

# Stream Cipher Design Considerations

The encryption sequence should have a large period. 
- A pseudorandom number generator uses a function that produces a deterministic stream of bits that eventually repeats; the longer the period of repeat the more difficult it will be to do cryptanalysis

The keystream should approximate the properties of a true random number stream as close as possible. 
- There should be an approximately equal number of 1s and 0s
- If the keystream is treated as a stream of bytes, then all of the 256 possible byte values should appear approximately equally often.

A key length of at least 128 bits is desirable.
- The output of the pseudorandom number generator is conditioned on the value of the input key.
- The same considerations that apply to block ciphers are valid.

With a properly designed pseudorandom number generator a stream cipher can be as secure as a block cipher of comparable key length.
- A potential advantage is that stream ciphers that do not use block ciphers as a building block are typically faster and use far less code than block ciphers.

# RC4

Designed in 1987 by Ron Rivest.

Variable key size stream cipher with byte-oriented operations.

Based on use of a random permutation.

Eight to sixteen machine operations are required per output byte and the cipher can be expected to run very quickly in software.

RC4 is used on the WiFi Protected Access (WPA) protocol that are part of the IEEE 802.11 wireless LAN standard.

It is optional for use in SSH and Kerberos.

RC4 was kept as a trade secret by RSA Secuurity until September 1994 when the RC4 algorithm was anonymously posted on the Internet on the Cyberpunks anonymous remailers list.

## Weakness in RC4

A fundamental vulnerability was revealed in the RC4 key scheduling algorithm that reduces the amount of effort to discover the key.

Recent cryptanalysis results exploit biases in the RC4 keystream to recover repeatedly encrypted plaintexts.

As a result of the discovered weaknesses the IETF issued RFC 7465 prohibiting the use of RC4 in TLS.

In the latest TLS guidelines, NIST also prohibited the use of RC4 for government use.

# Stream Ciphers Using Feedback Shift Registers

FSRs exhibit the desired performance behavior, are well-suited to compact hardware implementation, and there are well-developed theoretical results on the statistical properties of the bit sequences they produce  
- An FSR consists of a sequence of 1-bit memory cells  
- Each cell has an output line, which indicates the value currently stored, and an input line  
- At discrete time instants, known as clock times, the value in each storage device is replaced by the value indicated by its input line  
- The effect is as follows: The rightmost (least significant) bit is shifted out as the output bit for this clock cycle; the other bits are shifted one bit position to the right; the new leftmost (most significant) bit is calculated as a function of the other bits in the FSR

# Grain-128a: LFSRs and NFSRs based stream cipher

Grain is a family of hardware-efficient stream ciphers  

Grain was accepted as part of the eSTREAM effort to approve a number of new stream ciphers  

The eSTREAM specification, called Grain v1, defines two stream ciphers, one with an 80-bit key and a 64-bit initialization vector (IV), and one with a 128-bit key and 80-bit IV  

Grain has since been revised and expanded to include authentication, referred to as Grain-128a  

Grain-128a consists of two shift registers, one with linear feedback and the second with nonlinear feedback, and a filter function  

The registers are couple by very lightweight, but judiciously chosen Boolean functions  

The NFSR, together with a nonlinear filter, introduces nonlinearity to the cipher  

The input to the NFSR is masked with the output of the LFSR so that the state of the NFSR is balanced

# TRNGs

A true random number generator (TRNG) uses a nondeterministic source to produce randomness  

Most operate by measuring unpredictable natural processes such as pulse detectors of ionizing radiation events, gas discharge tubes, and leaky capacitors  

Intel has developed a commercially available chip that samples thermal noise by amplifying the voltage measured across undriven resistors  

LavaRnd is an open source project for creating truly random numbers using inexpensive cameras, open source code, and inexpensive hardware  
- The system uses a saturated CCD in a light-tight can as a chaotic source to produce the seed; software processes the result into truly random numbers in a variety of formats

```ad-note
title: Possible Sources of Randomness
- Sound/video input
	- The input from a sound digitizer with no source pluggin in, or from a camera with the lens cap on is essentially thermal noise
- Disk drives
	- Have small random fluctuations in their rotational speed due to chaotic air turbulence
```

# Comparison of PRNGs and TRNGs


|                 | Pseudorandom Number Generators | True Random Number Generators |
| --------------- | ------------------------------ | ----------------------------- |
| **Efficiency**  | Very efficient                 | Generally inefficient         |
| **Determinism** | Deterministic                  | Nondeterministic              |
| **Periodicity** | Periodic                       | Aperiodic                     |

# Intel Digital Random Number Generator

TRNGs have traditionally been used only for key generation and other applications where only a small number of random bits were required  
- This is because TRNGs have generally been inefficient with a low bit rate of random bit production  

The first commercially available TRNG that achieves bit production rates comparable with that of PRNGs is the Intel digital random number generator offered on new multicore chips since May 2012  
- It is implemented entirely in hardware  
- The entire DRNG is on the same multicore chip as the processors